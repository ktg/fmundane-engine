[{
  "id" : "layer1",

  "start": {
    "actions": [["fanoff","whitelights","togglewindows"]],
    "event": "ready?"
  },

  "events": [{
    "onstart":  [
      {
        "words": "Hello and welcome to the caravan. My name is Fred.",
        "delay": 500 
      },
      {
        "words": "Are you ready to go?"
      }
    ],
    "id": "ready?",
    "name": "ready?",
    "subscription" : "/speech",
    "type": "speech",
    "rules": [{
        "rule": {
          "operator": "contains",
          "operand": ["yes"]
        },
        "actions": [
          ["sayturningonfan","fanhot"]
        ],
        "next": "asknames"
      },
      {
        "rule": {
          "operator": "contains",
          "operand": ["no"]
        },
        "actions": [
          ["sayaskagain"]
        ],
        "next": "ready?"
      }
    ]
  },
  {
    "onstart": [
      {
          "words": "Would you be so kind as to tell me your names",
          "delay": 500
      }
    ],
    "id": "asknames",
    "name": "ask names",
    "subscription" : "/speech",
    "type": "speech",
    "rules": [{
        "rule": {
          "operator": "any"
        },
        "actions": [
          ["sayhello"]
        ],
        "next": "redlights"
      }
    ]
  },
  {
    "onstart": [
      {
        "words": "Time to turn our lights red,is that ok?"
      }
    ],     
    "id": "redlights",
    "name": "wizard next",
    "subscription" : "/press",
    "type": "button",
    "data": ["next"],
    "rules": [{
        "rule": {
          "operator": "equals",
          "operand": "next"
        },
        "actions": [
          ["redlights"]
        ],
        "next": "wizard2"
      }
    ]
  },
  {
    "onstart": [
      {
        "words": "I'm now going to print something.  Is that also ok?"
      }
    ],     
    "id": "wizard2",
    "name": "wizard yes/no",
    "subscription" : "/press",
    "type": "button",
    "data": ["yes","no"],
    "rules": [{
        "rule": {
          "operator": "equals",
          "operand": "yes"
        },
        "actions": [
          ["printsomething"]
        ],
        "next": "windows"
      },
      {
        "rule": {
          "operator": "equals",
          "operand": "no"
        },
        "actions": [
          ["saynoworries"],
          ["facecameraoff"]
        ],
        "next": "lights1"
      }
    ]
  },
  {
    "onstart":[
      {
        "words": "Time to play with the windows.  Put your thumbs up if that is ok!"
      }
    ],     
    "id": "windows",
    "name": "windows",
    "subscription" : "/gesture",
    "type": "gesture",
    "rules": [{
        "rule": {
          "operator": "equals",
          "operand": ["thumbsup"]
      } ,
        "actions": [
          ["togglewindows"]
        ],
        "next": "fin"
      }
    ]
  },
  {
    "onstart": [
      {
        "words": "Well - what colour would you like?"
      }
    ],    
    "id": "lights1",
    "name": "select light colour",
    "subscription" : "/press",
    "type": "button",
    "data": ["red", "blue", "green", "rainbow"],
    "rules": [{
        "rule": {
          "operator": "equals",
          "operand": "red"
        },
        "actions": [
          ["redlights"]
        ],
        "next": "fin"
      },
      {
        "rule": {
          "operator": "equals",
          "operand": "blue"
        },
        "actions": [
          ["bluelights"]
        ],
        "next": "fin"
      },
      {
        "rule": {
          "operator": "equals",
          "operand": "green"
        },
        "actions": [
          ["greenlights"]
        ],
        "next": "fin"
      },
      {
        "rule": {
          "operator": "equals",
          "operand": "rainbow"
        },
        "actions": [
          ["rainbowlights"]
        ],
        "next": "fin"
      }
    ]
  },
  {
    "onstart": [
      {
        "words": "Well I hope you had fun - we are done now!"
      }
    ],    
    "id": "fin",
    "name": "finished!",
    "subscription" : "/press",
    "type": "button",
    "data": ["done!"],
    "rules": [{
        "rule": {
          "operator": "equals",
          "operand": "done"
        },
        "actions": []
      }
    ]
  }
]},
{
  "id" : "layer2",

  "start": {
    "actions": [[]],
    "event": "listen"
  },

  "events": [{
    "onstart":  [],
    "id": "listen",
    "name": "listen",
    "subscription" : "/speech",
    "type": "speech",
    "rules": [{
        "rule": {
          "operator": "contains",
          "operand": ["humbug"]
        },
        "actions": [
          ["upbeatmusic"]
        ],
        "next": ""
      }
    ]
  }]
}

]
